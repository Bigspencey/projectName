function LoginPanel(){this.init();this.listen();}LoginPanel.prototype.init=function(){var loginInformation=clientSideData.LOGIN_INFORMATION;this.WDS_LOGOUT_FORM=$("#WDS_LOGOUT_FORM");if(typeof loginInformation!="undefined"&&loginInformation.IS_FAKE_LOGGED==true){var user=$.jStorage.get("userDetails");if(user==null||typeof(user.TITLE_1)==="undefined"||typeof(user.FIRST_NAME_1)==="undefined"||typeof(user.LAST_NAME_1)==="undefined"){user=null;}if(user==null){$("#loginLoadingState").removeClass("active").addClass("none");$("#loginNotLoggedState").removeClass("none").addClass("active");}else{$("#loginLoadingState").removeClass("active").addClass("none");$("#loginKnownNotLoggedState").removeClass("none").addClass("active");$("#loginKnownNotLoggedState #uiInputLogin").val(user["FREQ_NUMBER_1_1"]);$("#LATE_LOGIN_USERNAME").val(user["FREQ_NUMBER_1_1"]);}}else{if(typeof loginInformation!="undefined"&&loginInformation.IS_FAKE_LOGGED==false){$.jStorage.set("userDetails",loginInformation);}else{if($.jStorage.get("userDetails")!=null||$.jStorage.get("cachedLoginInfoObject")!=null){var user=$.jStorage.get("userDetails")||$.jStorage.get("cachedLoginInfoObject");if(user==null||typeof(user.TITLE_1)==="undefined"||typeof(user.FIRST_NAME_1)==="undefined"||typeof(user.LAST_NAME_1)==="undefined"||user.TITLE_1===""||user.TITLE_1==="undefined"){user=null;}if(user==null){$("#loginLoadingState").removeClass("active").addClass("none");$("#loginNotLoggedState").removeClass("none").addClass("active");}else{$("#loginLoadingState").removeClass("active").addClass("none");$("#loginKnownNotLoggedState").removeClass("none").addClass("active");$("#loginKnownNotLoggedState #uiInputLogin").val(user["FREQ_NUMBER_1_1"]);$("#LATE_LOGIN_USERNAME").val(user["FREQ_NUMBER_1_1"]);}}else{$("#loginLoadingState").removeClass("active").addClass("none");$("#loginNotLoggedState").removeClass("none").addClass("active");}}}this.logout=wdk.form("WDS_DYNAMIC_LOGOUT_FORM",{ajaxSubmit:true,ajaxOptions:{dataType:"json",success:function(data){$.jStorage.deleteKey("userDetails");$("#WDS_LOGOUT_FORM").submit();setTimeout(function(){$.blockUI();},10);},error:function(){$.jStorage.deleteKey("userDetails");}},errorPanel:$("#pageError")});};LoginPanel.prototype.logoutFn=function(){$.blockUI();var currentPageCode=clientSideData.PAGE_CODE;$.jStorage.deleteKey("userDetails");if($(".outbound  .selectedFF").length>0){$("#WDS_LOGOUT_FORM").append("<input name='outboundPreselected' value='"+theUtils.getPreselectedFlight("outbound")+"' type='hidden'>");$("#WDS_LOGOUT_FORM").append("<input name='outboundPreselectedFlightNumber' value='"+theUtils.getPreselectedFlightNumber("outbound")+"' type='hidden'>");$("#WDS_LOGOUT_FORM").append("<input name='outboundPreselectedFf' value='"+theUtils.getPreselectedFf("outbound")+"' type='hidden'>");}if($(".inbound  .selectedFF").length>0){$("#WDS_LOGOUT_FORM").append("<input name='inboundPreselected' value='"+theUtils.getPreselectedFlight("inbound")+"' type='hidden'>");$("#WDS_LOGOUT_FORM").append("<input name='inboundPreselectedFlightNumber' value='"+theUtils.getPreselectedFlightNumber("inbound")+"' type='hidden'>");$("#WDS_LOGOUT_FORM").append("<input name='inboundPreselectedFf' value='"+theUtils.getPreselectedFf("inbound")+"' type='hidden'>");}if(currentPageCode=="RD_UPSL"){$("#WDS_DYNAMIC_LOGOUT_FORM").submit();}else{$("#loginLoadingState").removeClass("none").addClass("active");$("#loginLoggedState").removeClass("active").addClass("none");$("#WDS_DYNAMIC_LOGOUT_FORM").submit();}};LoginPanel.prototype.listen=function(){var self=this;$(".tam-header-wrapper").on("mouseenter","#logbutton",function(){$("#logpanel").slideDown();$("#logarrow").removeClass("log-arrow-down").addClass("log-arrow-up");});$(".tam-header-wrapper").on("mouseleave","#logpanel",function(){$("#logpanel").slideUp();$("#logarrow").removeClass("log-arrow-up").addClass("log-arrow-down");});$("#notMeLogoutLink").on("click",function(){$("#loginKnownNotLoggedState").removeClass("active").addClass("none");$("#loginNotLoggedState").removeClass("none").addClass("active");$.jStorage.deleteKey("userDetails");});if(clientSideData.PAGE_CODE=="CP_UPSL"){$(".tam-header-bar").on("click","#logoutLink",function(){self.popinLogout=$("#popinLogout");self.popinLogout.dialog({autoOpen:true,draggable:false,width:800,modal:true,resizable:false});});$("#confirmLogout").on("click",function(){self.logoutFn();});$("#cancelLogout").on("click",function(){self.popinLogout.dialog("destroy");});}else{$(".tam-header-bar").on("click","#logoutLink",function(event){if(clientSideData.NO_PNRS_FOUND!=null&&clientSideData.NO_PNRS_FOUND.toLowerCase()=="true"){document.GO_TO_SEARCH_FORM.submit();}else{self.logoutFn();}});}};$(function(){window.theLoginPanel=new LoginPanel();});