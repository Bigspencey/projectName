/*   OnlineOpinion v5.7.4 Released: 7/2/2013. Compiled 07/02/2013 08:59:24 AM -0500 Branch: master 65b330c1881ac4ae6253e4fc5232002c2a1614c3 Components: Full The following code is Copyright 1998-2013 Opinionlab, Inc.  All rights reserved. Unauthorized use is prohibited. This product and other products of OpinionLab, Inc. are protected by U.S. Patent No. 6606581, 6421724, 6785717 B1 and other patents pending. http://www.opinionlab    */(function(a,b){if(typeof define==='function'&&define.amd){define([],b)}else{a.OOo=b()}}(this,function(){var d={__detectBrowser:function(a){var b=Object.prototype.toString.call(window.opera)==='[object Opera]',c={IE:!!window.attachEvent&&!b,Opera:b,WebKit:a.indexOf('AppleWebKit/')>-1,Chrome:a.indexOf('Chrome')>-1,Gecko:a.indexOf('Gecko')>-1&&a.indexOf('KHTML')===-1,MobileSafari:/Apple.*Mobile.*Safari/.test(a),PalmPre:a.indexOf('Pre/')>-1,BlackBerry:a.indexOf('BlackBerry')>-1,Fennec:a.indexOf('Fennec')>-1,IEMobile:a.indexOf('IEMobile')>-1,OperaMobile:a.search(/Opera (?:Mobi|Mini)/)>-1,Kindle:a.search(/[ ](Kindle|Silk)/)>-1,ua:a},e=false;c.isMobile=(c.MobileSafari||c.PalmPre||c.BlackBerry||c.Fennec||c.IEMobile||c.OperaMobile||c.Kindle);c.isMobileNonIOS=(c.isMobile&&(!c.MobileSafari||a.search('Android')!==-1));return c}};d.Browser=d.__detectBrowser(navigator.userAgent);d.Cache={};d.instanceCount=0;d.K=function(){};var G=G||d;(function(){function l(a){return document.getElementById(a)}function m(a,b){var c;for(c in b){if(b.hasOwnProperty(c)){a[c]=b[c]}}return a}function n(a,b,c,e){if(a.addEventListener){a.addEventListener(b,c,e)}else if(a.attachEvent){a.attachEvent('on'+b,c)}}function s(a,b,c,e){if(a.removeEventListener){a.removeEventListener(b,c,e)}else if(a.detachEvent){a.detachEvent('on'+b,c)}}function p(a){var b=[],c;for(c in a){if(a.hasOwnProperty(c)){b.push(c+'='+(encodeURIComponent(a[c])||''))}}return b.join('&')}function u(a){var b=p(a.metrics),c=a.tealeafId+'|'+a.clickTalePID+'/'+a.clickTaleUID+'/'+a.clickTaleSID;b+='&custom_var='+d.createLegacyVars(a.legacyVariables,c);if(a.metrics.type==='OnPage'){b+='|iframe'}if(a.asm){b+='&asm=2'}b+="&_"+'rev=2';if(a.customVariables){b+='&customVars='+encodeURIComponent(d.serialize(a.customVariables))}return b}function o(a,b){var c=document,e=c.createElement('form'),f=c.createElement('input'),g=a.referrerRewrite;a.metrics.referer=location.href;if(g){a.metrics.referer=d.referrerRewrite(g)}e.style.display='none';e.method='post';e.target=b||'OnlineOpinion';e.action=a.onPageCard?'https://secure.opinionlab.com/ccc01/comment_card_json_4_0_b.asp?r='+location.href:'https://secure.opinionlab.com/ccc01/comment_card_d.asp';if(a.commentCardUrl){e.action=a.commentCardUrl;if(a.onPageCard){e.action+='?r='+location.href}}f.name='params';f.value=u(a);e.appendChild(f);c.body.appendChild(e);return e}function t(){return{width:screen.width,height:screen.height,referer:location.href,prev:document.referrer,time1:(new Date()).getTime(),time2:null,currentURL:location.href,ocodeVersion:'5.7.4'}}function v(a){var b='';if(a&&a.search('://')>-1){var c=a.split('/');for(i=3;i<c.length;i++){b+="/";b+=c[i]}}return b}function q(a,b){a=a||{};if(typeof a==='string'){return b+'|'+a}return a.override?a.vars:b+(a.vars?'|'+a.vars:'')}function r(a,b){if(!b){b=location}if(typeof a==="string")return a;return a.searchPattern?b.href.replace(a.searchPattern,a.replacePattern):a.replacePattern}var x=(function(){var a=document.body,b,c,e,f,g;if(document.createElement&&a&&a.appendChild&&a.removeChild){b=document.createElement('div');if(!b.getBoundingClientRect){return null}b.innerHTML='x';b.style.cssText='position:fixed;top:100px;';a.appendChild(b);c=a.style.height;e=a.scrollTop;a.style.height='3000px';a.scrollTop=500;f=b.getBoundingClientRect().top;a.style.height=c;g=(f===100);a.removeChild(b);a.scrollTop=e;return g}return null}()),y=(function(){if(navigator.appName==="Microsoft Internet Explorer"&&navigator.userAgent.search("MSIE 6")!==-1){return true}var a=document.body,b,c;if(document.createElement&&a&&a.appendChild&&a.removeChild){b=document.createElement('iframe');c=false;b.setAttribute('name','oo_test');b.style.display='none';a.appendChild(b);c=!!!document.getElementsByName('oo_test')[0];a.removeChild(b);return c}else{return null}}());function w(){d.$('oo_container').style.display='none'}function B(){var a=d.$('oo_invitation_prompt');if(a){var b=d.$('oo_container');this.showPrompt(b);return}var c=window.XMLHttpRequest?new XMLHttpRequest():new window.ActiveXObject("Microsoft.XMLHTTP"),e=this,f=document.createElement('link'),g;c.onreadystatechange=function(){if(c.readyState!==4){return}e.showPrompt(c.responseText)};c.open("GET",this.options.pathToAssets+this.options.promptMarkup,true);c.send(null)}function z(a,b){var c=document,e=typeof a==='string'?c.createElement('div'):a,f=c.createElement('div'),g,h,j=this.options,k;f.id='oo_invitation_overlay';e.id='oo_container';e.style.visibility='hidden';if(typeof a==='string'){e.innerHTML=a;c.body.appendChild(e)}e.appendChild(f);k=d.$('oo_launch_prompt');if(j.companyLogo){g=new Image();g.src=j.companyLogo;d.$('oo_company_logo').appendChild(g)}d.addEventListener(k,'click',b.bind(this),false);if(j.clickCallbacks){if(typeof j.clickCallbacks.yes==='function'){d.addEventListener(k,'click',function(){j.clickCallbacks.yes()},false)}if(typeof j.clickCallbacks.no==='function'){d.addEventListener(d.$('oo_no_thanks'),'click',function(){j.clickCallbacks.no()},false)}}if(j.neverShowAgainButton){h=d.$('oo_never_show');h.style.visibility='visible';d.addEventListener(h,'click',this.killPrompt.bind(this),false)}if(d.Browser.IE&&!window.XMLHttpRequest){f.style.position='absolute';f.style.width=Math.max(document.documentElement.clientWidth,document.body.offsetWidth)+'px';f.style.height=Math.max(document.documentElement.clientHeight,document.body.offsetHeight)+'px';e.style.position='absolute'}e.style.visibility='visible';e.style.display='block';f.className='no_loading'}m(d,{extend:m,toQueryString:p,addEventListener:n,$:l,appendOOForm:o,removeEventListener:s,createMetrics:t,truncateMetric:v,createLegacyVars:q,POSITION_FIXED_SUPPORTED:x,DYNAMIC_FRAME_NAME_IS_BUGGY:y,getFormParams:u,referrerRewrite:r,hidePrompt:w,getPrompt:B,showPrompt:z})}());(function(){function g(a){if(!a){return null}switch(typeof a){case'number':case'boolean':case'function':return a;case'string':return'\''+a+'\'';case'object':var b,c,e,f;if(a.constructor===Array||typeof a.callee!=='undefined'){b='[';e=a.length;for(c=0;c<e-1;c+=1){b+=g(a[c])+','}b+=g(a[c])+']'}else{b='{';for(f in a){if(a.hasOwnProperty(f)){b+=f+':'+g(a[f])+','}}b=b.replace(/\,$/,'')+'}'}return b;default:return null}}d.extend(d,{serialize:g})}());(function(){function f(a,b,c){var e;if(a.search(b[0])!==-1){d.createCookie(c,0);return false}else if(d.readCookie(c)){e=parseInt(d.readCookie(c),10);if((a.search(b[e+1])!==-1)&&(e+1!==b.length-1)){d.createCookie(c,e+1);return false}else if(a.search(b[e])!==-1){return false}else if(e+1===b.length-1&&a.search(b.pop())!==-1){d.eraseCookie(c);return true}else{d.eraseCookie(c);return false}}else{return false}}d.extend(d,{checkTunnel:f})}());(function(){function t(a){var b="",c;for(c=7;c>=0;c-=1){b+='0123456789abcdef'.charAt((a>>(c*4))&0x0F)}return b}function v(a){var b=((a.length+8)>>6)+1,c=new Array(b*16),e;for(e=0;e<b*16;e+=1){c[e]=0}for(e=0;e<a.length;e+=1){c[e>>2]|=a.charCodeAt(e)<<(24-(e%4)*8)}c[e>>2]|=0x80<<(24-(e%4)*8);c[b*16-1]=a.length*8;return c}function q(a,b){var c=(a&0xFFFF)+(b&0xFFFF),e=(a>>16)+(b>>16)+(c>>16);return(e<<16)|(c&0xFFFF)}function r(a,b){return(a<<b)|(a>>>(32-b))}function x(a,b,c,e){if(a<20){return(b&c)|((~b)&e)}if(a<40){return b^c^e}if(a<60){return(b&c)|(b&e)|(c&e)}return b^c^e}function y(a){return(a<20)?1518500249:(a<40)?1859775393:(a<60)?-1894007588:-899497514}function w(a){var b=v(a),c=new Array(80),e=1732584193,f=-271733879,g=-1732584194,h=271733878,j=-1009589776,k,l,m,n,s,p,u,o;for(u=0;u<b.length;u+=16){k=e;l=f;m=g;n=h;s=j;for(o=0;o<80;o+=1){if(o<16){c[o]=b[u+o]}else{c[o]=r(c[o-3]^c[o-8]^c[o-14]^c[o-16],1)}p=q(q(r(e,5),x(o,f,g,h)),q(q(j,c[o]),y(o)));j=h;h=g;g=r(f,30);f=e;e=p}e=q(e,k);f=q(f,l);g=q(g,m);h=q(h,n);j=q(j,s)}return t(e)+t(f)+t(g)+t(h)+t(j)}d.extend(d,{sha1:w})}());(function(){function j(a,b){if(!b){b=location}var c=a.cookieName||'oo_abandon',e=d.readCookie(c),f=a.startPage,g=a.endPage,h=a.middle;if(!e){if(b.pathname.indexOf(f)!==-1){d.createCookie(c)}return false}else if(b.pathname.indexOf(g)!==-1){d.eraseCookie(c);return false}else if(b.pathname.search(h)!==-1){return false}else{d.eraseCookie(c);return true}}d.extend(d,{checkAbandonment:j})}());(function(){function e(a){var b,c;for(b=a.length-1;b>=0;b-=1){if(a[b].read){c=d.readCookie(a[b].name);if(!!c&&c===a[b].value){return true}else if(typeof a[b].value==='undefined'&&!!d.readCookie(a[b].name)){return true}}}return false}function f(a){var b;for(b=a.length-1;b>=0;b-=1){if(a[b].set){d.createCookie(a[b].name,a[b].value,a[b].expiration)}}}d.extend(d,{checkThirdPartyCookies:e,setThirdPartyCookies:f})}());d.extend(Function.prototype,(function(){if(typeof Function.prototype.bind!=="undefined"){return}var f=Array.prototype.slice;function g(a,b){var c=a.length,e=b.length;while(e){e-=1;a[c+e]=b[e]}return a}function h(a,b){a=f.call(a,0);return g(a,b)}function j(b){if(arguments.length<2&&typeof b==="undefined"){return this}var c=this,e=f.call(arguments,1);return function(){var a=h(e,arguments);return c.apply(b,a)}}return{bind:j}}()));(function(){function g(a){if(!a){a=location}var b;if(a.host.search(/\.[a-z]+/)!==-1){b=a.host.split('.').reverse();if(b.length>3){return a.host}b='.'+b[1]+'.'+b[0]}else{b=a.host}return b}function h(a,b,c){var e='',f='';if(c){e=new Date();e.setTime(e.getTime()+(c*1000));f="; expires="+e.toGMTString()}if(location.host!==g()){document.cookie=a+"="+b+f+"; path=/; domain="+g()+";"}else{document.cookie=a+"="+b+f+"; path=/;"}}function j(a){var b=a+"=",c=document.cookie.split(';'),e,f;for(f=0;f<c.length;f+=1){e=c[f];while(e.charAt(0)===' '){e=e.substring(1,e.length)}if(e.indexOf(b)===0){return e.substring(b.length,e.length)}}return null}function k(a){h(a,"",-1)}d.extend(d,{getCookieDomain:g,createCookie:h,readCookie:j,eraseCookie:k})}());d.Ocode=function(a){var b=d.Browser,c,e;if(a.disableMobile&&b.isMobile){return}if(a.disableNoniOS&&b.isMobileNonIOS){return}d.instanceCount+=1;this.options={tealeafCookieName:'TLTSID'};d.extend(this.options,a);c=this.options;c.metrics=d.createMetrics();this.frameName=c.onPageCard?'OnlineOpinion'+d.instanceCount:'OnlineOpinion';if(c.cookie&&d.Ocode.matchUrl(c.cookie,location)){return}if(c.thirdPartyCookies&&d.checkThirdPartyCookies(c.thirdPartyCookies)){return}if(c.abandonment&&!d.checkAbandonment(c.abandonment)){return}if(c.tunnel&&!d.checkTunnel(location.pathname,c.tunnel.path,c.tunnel.cookieName)){return}if(c.events&&c.events.onSingleClick){this.singProbability=Math.random()<1-c.events.onSingleClick/100}c.tealeafId=d.readCookie(c.tealeafCookieName)||d.readCookie(c.sessionCookieName);if(c.events){this.setupEvents();if(c.events.disableLinks||c.events.disableFormElements){this.setupDisableElements()}}if(c.floating){this.floating()}else if(c.bar){this.bar()}else if(c.tab){this.tab()}};d.Ocode.prototype={show:function(a,b){if(a==='Tab'&&b&&b.preventDefault){b.preventDefault()}if(this.onPageCardVisible){return}var c=this.options,e;if(c.events&&c.events.prompt){if(c.cookie)d.eraseCookie(c.cookie.name||'oo_r');d.hidePrompt()}if(this.interruptShow){return}if(!this.floatingLogo&&c.cookie&&d.Ocode.matchUrl(c.cookie)){return}if(!c.floating&&c.events&&this.singProbability){return}if(c.events&&c.events.onSingleClick){this.singProbability=true}if(c.cookie){d.Ocode.tagUrl(c.cookie)}if(c.thirdPartyCookies){if(d.checkThirdPartyCookies(c.thirdPartyCookies)){return}d.setThirdPartyCookies(c.thirdPartyCookies)}if(this.floatingLogo){this.floatingLogo.children[0].blur()}if(this.floatingLogo&&c.disappearOnClick){this.floatingLogo.style.display='none'}if(a){c.metrics.trigger=a}if(c.clickTalePID&&typeof window.ClickTale==='function'){c.clickTaleUID=window.ClickTaleGetUID();c.clickTaleSID=window.ClickTaleGetSID()}if(c.onPageCard&&!d.Browser.isMobile){this.setupOnPageCC()}else{this.launchOOPopup()}e=c.floating||c.tab||c.bar;if(e&&typeof e.onClickCallback==='function'){e.onClickCallback()}}};d.extend(d.Ocode,{tagUrl:function(a,b){if(!b){b=location}var c=a.name||'oo_r',e=a.type==='page'?b.href:b.hostname,f=d.readCookie(c)||'';if(d.Ocode.matchUrl(a,b)){return}d.createCookie(c,f+d.sha1(e),a.expiration)},matchUrl:function(a,b){if(!b){b=location}var c=d.readCookie(a.name||'oo_r'),e;if(!c){return false}e=a.type==='page'?b.href:b.hostname;return c.search(d.sha1(e))!==-1}});(function(){var h=0;function j(){var a=this.options,b=a.newWindowSize||[545,325],c=[parseInt((a.metrics.height-b[1])/2,10),parseInt((a.metrics.width-b[0])/2,10)],e,f,g='location=no,status=no,scrollbars=1,width='+b[0]+',height='+b[1]+',top='+c[0]+',left='+c[1];ie7=d.Browser.IE&&navigator.userAgent.search('MSIE 7')!==-1,windowName='OnlineOpinion';if(a.newWindow)windowName=windowName+(h++);a.metrics.time2=(new Date()).getTime();a.metrics.type='Popup';e=d.appendOOForm(a,windowName);if(d.Browser.isMobile&&d.Browser.ua.search('Android')!==-1){e.submit()}else{f=window.open(ie7?a.commentCardUrl||'https://secure.opinionlab.com/ccc01/comment_card_d.asp?'+e.children[0].value:'',windowName,g);if(f&&!ie7){e.submit()}}}d.extend(d.Ocode.prototype,{launchOOPopup:j})}());(function(){function l(){var a=this.options.events,b=[false,false],c=['onExit','onEntry'],e=d.Browser.Opera?'unload':'beforeunload',f,g,h,j,k;if(a.prompt){d.extend(this.options,{promptMarkup:a.prompt.promptMarkup||'oo_event_prompt.html',neverShowAgainButton:false,pathToAssets:a.prompt.pathToAssets})}for(h=c.length-1;h>=0;h-=1){f=c[h];if(a[f]instanceof Array){j=a[f];k=j.length;while(k&&!b[h]){k-=1;if(window.location.href.search(j[k].url)!==-1&&Math.random()>=1-j[k].p/100){b[h]=true}}}else if(a[f]&&Math.random()>=1-a[f]/100){b[h]=true}}if(b[0]){d.addEventListener(window,e,this.show.bind(this,'onExit'),false)}if(b[1]){if(a.delayEntry){window.setTimeout(function(){if(a.prompt)this.getPrompt();else this.show()}.bind(this,'onEntry'),a.delayEntry*1000)}else{if(a.prompt)this.getPrompt();else this.show('onEntry')}}}function m(a){var b=a||window.event,c=a.target||a.srcElement,e=this.options.events,f=c.parentNode,g=5,h=0;while(f&&(c.nodeName!=='A'||c.nodeName!=='INPUT')&&h!==g){if(f.nodeName==='A'){c=f}f=f.parentNode;h+=1}if(e.disableFormElements&&(c.tagName==="INPUT"||c.tagName==="BUTTON")&&(c.type==='submit'||c.type==='image'||c.type==='reset'||c.type==='button')){this.interruptShow=true}if(e.disableLinks&&(c.nodeName==='A'||c.nodeName==='AREA')&&c.href.substr(0,4)==='http'&&c.href.search(e.disableLinks)!==-1){this.interruptShow=true}}function n(a){this.interruptShow=true}function s(){d.addEventListener(document.body,'mousedown',m.bind(this));if(!this.options.events.disableFormElements){return}var a=document.getElementsByTagName('form'),b;for(b=a.length-1;b>=0;b-=1){d.addEventListener(a[b],'submit',n.bind(this))}}d.extend(d.Ocode.prototype,{setupEvents:l,setupDisableElements:s,getPrompt:function(){d.getPrompt.call(this)},showPrompt:function(a){if(this.options.cookie){d.Ocode.tagUrl(this.options.cookie)}d.showPrompt.call(this,a,this.show)}})}());d.extend(d.Ocode.prototype,{floating:function(){var e=document,f=this.floatingLogo=document.createElement('div'),g=e.createElement('div'),h=e.createElement('div'),j=e.createElement('div'),k=e.createElement('span'),l=this.options.floating,m=d.$(l.contentId),n='10px',s=l.id,p=e.createElement('span'),u,o,t,v,q,r,x,y;function w(a){return a.offsetLeft+a.offsetWidth}function B(a){v.style.left=w(m)+'px'}p.innerHTML="Screen reader users: Please switch to forms mode for this link.";p.className="screen_reader";if(s){f.id=s}f.className='oo_feedback_float';h.className='oo_transparent';g.className='olUp';j.className='olOver';g.tabIndex=0;g.onkeyup=function(a){u=a||window.event;if(u.keyCode!==13){return}this.show()}.bind(this);g.innerHTML=l.caption||'Feedback';f.appendChild(p);f.appendChild(g);k.innerHTML=l.hoverCaption||'Click here to<br>rate this page';j.appendChild(k);f.appendChild(j);f.appendChild(h);function z(a){var b=e.documentElement.scrollTop||e.body.scrollTop,c=e.documentElement.clientHeight||document.body.clientHeight;f.style.top=(b+c-(x||0)-10)+'px'}if(d.Browser.MobileSafari){if(d.Browser.ua.search('OS 4')!==-1){o=window.innerHeight;f.style.bottom=null;f.style.top=(window.pageYOffset+window.innerHeight-60)+'px';y=function(a){t=window.pageYOffset-(o-window.innerHeight);f.style.webkitTransform='translateY('+t+'px)'};d.addEventListener(window,'scroll',y,false);setTimeout(y,100)}}else if(!d.POSITION_FIXED_SUPPORTED){f.style.position='absolute';f.style.bottom='';d.addEventListener(window,'scroll',z,false);d.addEventListener(window,'resize',z,false);if(e.compatMode==="BackCompat"){f.style.background="white"}}if(l.position&&l.position.search(/Content/)&&m){v=this.spacer=e.createElement('div');q=d.Browser.WebKit?e.body:e.documentElement;v.id='oo_feedback_fl_spacer';v.style.left=w(m)+'px';e.body.appendChild(v);switch(l.position){case'rightOfContent':r=function(a){f.style.left=(w(m)-q.scrollLeft)+'px';if(!d.POSITION_FIXED_SUPPORTED){r=null}};break;case'fixedPreserveContent':r=function(a){var b=d.Browser.IE?e.body.clientWidth:window.innerWidth,c=d.POSITION_FIXED_SUPPORTED?q.scrollLeft:0;if(b<=w(m)+f.offsetWidth+parseInt(n,10)){f.style.left=(w(m)-c)+'px'}else{f.style.left='';f.style.right=n}};break;case'fixedContentMax':r=function(a){var b=d.Browser.IE?e.body.clientWidth:window.innerWidth;if(b<=w(m)+f.offsetWidth+parseInt(n,10)){f.style.left='';f.style.right=n;if(!d.POSITION_FIXED_SUPPORTED&&a&&a.type==='scroll'){f.style.left=(e.body.clientWidth+e.body.scrollLeft-105)+'px'}}else{f.style.left=(w(m)-q.scrollLeft)+'px';f.style.right=''}};break}window.setTimeout(r,0);d.addEventListener(window,'scroll',r,false);d.addEventListener(window,'resize',r,false);d.addEventListener(window,'resize',B,false)}else{f.style.right=n}d.addEventListener(f,'click',this.show.bind(this,'Floating'),false);d.addEventListener(f,'touchend',this.show.bind(this,'Floating'),false);e.body.appendChild(f);if(!d.POSITION_FIXED_SUPPORTED&&!d.Browser.MobileSafari){h.style.height=f.clientHeight+'px';x=f.clientHeight;setTimeout(z,100)}},removeFloatingLogo:function(){document.body.removeChild(this.floatingLogo);if(this.spacer){document.body.removeChild(this.spacer)}}});d.extend(d.Ocode.prototype,{bar:function(){var e=document,f=this.floatingLogo=e.createElement('div'),g=e.createElement('span'),h,j,k,l=e.documentElement.scrollTop||e.body.scrollTop,m=e.createElement('div');function n(a){var b=curtop=0;if(a.offsetParent){do{b+=a.offsetLeft;curtop+=a.offsetTop}while(a=a.offsetParent);return[b,curtop]}}function s(a){var b=document.activeElement,c;if(!b)return;c=n(b);if(!c)return;if(c[1]+b.clientHeight>(window.innerHeight||document.body.clientHeight)+(window.pageYOffset||document.body.scrollTop)-f.clientHeight)window.scrollBy(0,b.clientHeight+20)}m.innerHTML='Link opens comment card';m.className='screen_reader';f.appendChild(m);this.reflowBar=d.K;f.id='oo_bar';g.innerHTML=this.options.bar.caption||'Feedback';f.appendChild(g);f.tabIndex=0;f.onkeyup=function(a){var b=a||window.event;if(b.keyCode!==13){return}this.show()}.bind(this);d.addEventListener(f,'click',this.show.bind(this,'Bar'));document.body.className+=document.body.className<1?'oo_bar':' oo_bar';document.body.appendChild(f);var p=/MSIE ([\d\.]+);/.exec(window.navigator.userAgent);if(d.Browser.IE&&p&&+p[1]<8){if(e.compatMode==='CSS1Compat'){h=function(a){if(a&&a.type==='resize'){setTimeout(h,50)}f.style.top=(e.documentElement.scrollTop+document.documentElement.clientHeight-f.clientHeight-1)+'px';f.style.width=(Math.max(e.documentElement.clientWidth,e.body.offsetWidth))+'px'}}else{h=function(a){f.style.top=(e.body.scrollTop+document.body.clientHeight-f.clientHeight-1)+'px';f.style.width=(Math.max(e.documentElement.clientWidth,e.body.offsetWidth)-22)+'px'}}f.style.position='absolute';d.addEventListener(window,'scroll',h,false);d.addEventListener(window,'resize',h,false);this.reflowBar=function(){f.style.display='none';h();f.style.display='block'};h()}else if(d.Browser.MobileSafari&&d.Browser.ua.search('OS 4')!==-1){j=window.innerHeight;f.style.bottom=null;f.style.top=(window.pageYOffset+window.innerHeight-22)+'px';h=function(a){k=window.pageYOffset-(j-window.innerHeight);f.style.webkitTransform='translateY('+k+'px)'};d.addEventListener(window,'scroll',h,false);setTimeout(h,100)}d.addEventListener(document.body,'keyup',s,false)}});d.extend(d.Ocode.prototype,{tab:function(){var f=document,g=this.floatingLogo=f.createElement('div'),h=f.createElement('div'),j=f.createElement('div'),k=f.createElement('span'),l=this.options.tab;if(l.wcagBasePath){j=f.createElement('a');j.setAttribute('href','#');k=f.createElement('img');k.className='logo';k.setAttribute('alt',"Feedback");k.setAttribute('src',l.wcagBasePath+((d.Browser.ua.search('IE 6')!==-1)?"oo_tabie6.png":"oo_tab.png"))}function m(a){var b=f.documentElement.scrollTop||f.body.scrollTop,c=f.documentElement.scrollLeft||f.body.scrollLeft,e=f.documentElement.clientHeight||document.body.clientHeight;g.style.top=(b+(e/2-g.clientHeight/2))+'px';if((!l.position||l.position==='right'))g.style.right=(-1*c+2)+'px'}function n(a){g.style.top=pageYOffset+(innerHeight/2-g.clientHeight/2)+'px';g.style.right=document.documentElement.clientWidth-window.innerWidth-window.pageXOffset-15+'px'}g.id='oo_tab';g.className='oo_tab_'+(l.position||'right');if(l.wcagBasePath){g.className+=' wcag'}if(!d.POSITION_FIXED_SUPPORTED&&!d.Browser.MobileSafari){g.style.position='absolute';if((!l.position||l.position==='right')&&d.Browser.IE){g.className+=' oo_tab_ie_right';if(d.Browser.ua.search('IE 6')!==-1||d.Browser.ua.search('IE 7')!==-1){g.className+='  oo_tab_ie67_right'}if(d.Browser.ua.search('IE 6')===-1){d.addEventListener(window,'scroll',m,false);d.addEventListener(window,'resize',m,false)}}}if(typeof l.tabIndex==='number'){g.tabIndex=l.tabIndex}else if(typeof l.tabIndex==='undefined'){g.tabIndex=0}g.onkeyup=function(a){var b=a||window.event;if(b.keyCode!==13){return}this.show()}.bind(this);j.appendChild(k);g.appendChild(j);if(h){h.className='screen_reader';h.innerHTML='Activate to launch comment card';g.appendChild(h)}d.addEventListener(g,'click',this.show.bind(this,'Tab'),false);f.body.appendChild(g);if(d.Browser.MobileSafari&&d.Browser.ua.search('OS 4')!==-1){g.style.position='absolute';d.addEventListener(window,'scroll',n,false);setTimeout(n,100)}}});d.extend(d.Ocode.prototype,{setupOnPageCC:function(){var f=document,g=d.Cache.overlay||f.createElement('div'),h=this.wrapper=f.createElement('div'),j=f.createElement('div'),k=f.createElement('div'),l=f.createElement('span'),m=this.frameName,n=f.createElement(d.DYNAMIC_FRAME_NAME_IS_BUGGY?'<iframe name="'+m+'">':'iframe'),s=f.createDocumentFragment(),p=this.options,u=p.onPageCard,o='https://secure.opinionlab.com/ccc01/comment_card_json_4_0_b.asp',t,v,q,r=false,x=this,y,w,B,z,C,F,D,E=f.createElement('span');function A(a){if(a&&a.preventDefault){a.preventDefault()}document.body.focus();n.tabIndex=-1;n.title="empty";n['aria-hidden']='true';g.style.display='none';g.className='';f.body.removeChild(h);if(window.postMessage){d.removeEventListener(window,'message',C)}else{window.clearInterval(v)}r=false;x.onPageCardVisible=false;return false}C=d.Ocode.postMessageHandler(function(a){var b=parseInt(a,10),c,e;if(b>0){if(r){return}r=true;c=window.innerHeight||f.documentElement.clientHeight||f.body.clientHeight;e=b;D=h.offsetTop;if(e+D>c){e=c-40-D}n.style.width='555px';k.style.width='555px';n.style.height=e+'px';h.style.visibility='visible';if(l.clientHeight<20){l.style.height=h.offsetHeight+'px'}g.className="no_loading";x.onPageCardVisible=true;t&&f.body.removeChild(t)}else if(a==='submitted'){A()}if(d.Browser.IE&&f.compatMode==="BackCompat"){window.scrollTo(0,0)}},x.options.commentCardUrl);p.metrics.type='OnPage';d.Cache.overlay=g;g.id='oo_overlay';g.style.display='block';g.className='';k.className='iwrapper';h.className='oo_cc_wrapper';h.setAttribute('role','alert');h.setAttribute('aria-describedby','comment_card_description');E.className='screen_reader';E.id='comment_card_description';E.innerHTML='Please leave your feedback in the comment card you just activated';h.appendChild(E);j.className='oo_cc_close';j.innerHTML='<span class="screen_reader">Link closes comment card</span>X';j.title='Click to close comment card';h.style.visibility='hidden';j.tabIndex=0;j.onkeyup=function(a){var b=a||window.event;if(b.keyCode!==13){return}A()};if(d.Browser.IE){n.frameBorder='0';if(!window.XMLHttpRequest||f.compatMode==="BackCompat"){F=Math.max(f.documentElement.clientWidth,f.body.offsetWidth);g.style.position='absolute';g.style.width=f.compatMode==="BackCompat"?(F-21)+'px':F+'px';g.style.height=Math.max(f.documentElement.clientHeight,f.body.offsetHeight)+'px';h.style.position='absolute';d.addEventListener(window,'scroll',function(){g.style.top=(f.body.scrollTop+document.body.clientHeight-g.clientHeight)+'px';h.style.top=(f.body.scrollTop+D+25)+'px'})}}d.addEventListener(j,'click',A);if(u.closeWithOverlay&&!d.Browser.isMobile){h.appendChild(l);l.onclick=A;g.onclick=A}n.src=' ';n.name=m;n.title='Comment Card';k.appendChild(j);k.appendChild(n);h.appendChild(k);s.appendChild(h);s.appendChild(g);f.body.appendChild(s);if(window.postMessage){d.addEventListener(window,"message",C)}else{v=setInterval(C,500)}p.metrics.time2=(new Date()).getTime();t=d.appendOOForm(p,m);t.submit()}});d.extend(d.Ocode,{postMessageHandler:function(e,f,g){return function(a){var b='https://secure.opinionlab.com',c;if(!g){g=location}if((a&&!(a.origin===b||a.origin.indexOf(f)!==0))||(!a&&g.hash.search('OL=')===-1)){return false}c=a?a.data:g.hash.split('=').pop();if(!a&&location.hash){location.hash=''}e(c);return c}}});d.Invitation=function(a){if(d.Browser.isMobile){return}this.options={tunnelCookie:'oo_inv_tunnel',repromptTime:604800,responseRate:50,repromptCookie:'oo_inv_reprompt',promptMarkup:'oo_inv_prompt.html',promptStyles:'oo_inverstitial_style.css',percentageCookie:'oo_inv_percent',pagesHitCookie:'oo_inv_hit',popupType:'popunder',promptDelay:0,neverShowAgainButton:false,loadPopupInBackground:false,truncatePrevCurrentMetrics:false,disablePrevCurrentMetrics:false,tealeafCookieName:'TLTSID',monitorWindow:'oo_inv_monitor.html',beforePrompt:d.K};this.popupShown=false;d.extend(this.options,a);var b=this.options,c=parseInt(d.readCookie(b.pagesHitCookie),10)||0;d.Invitation.friendlyDomains=b.friendlyDomains||null;var e={weight:Number(d.readCookie('oo_OODynamicRewrite_weight')),searchPattern:d.readCookie('oo_OODynamicRewrite_searchPattern'),replacePattern:d.readCookie('oo_OODynamicRewrite_replacePattern')};d.eraseCookie('oo_OODynamicRewrite_weight');d.eraseCookie('oo_OODynamicRewrite_searchPattern');d.eraseCookie('oo_OODynamicRewrite_replacePattern');if(!window.OOoDynamicRewrite||window.OOoDynamicRewrite.weight<e.weight){window.OOoDynamicRewrite=e}if(window.OOoDynamicRewrite&&('number'===typeof window.OOoDynamicRewrite.weight)&&!isNaN(window.OOoDynamicRewrite.weight)){d.createCookie('oo_OODynamicRewrite_weight',window.OOoDynamicRewrite.weight);if(window.OOoDynamicRewrite.searchPattern){d.createCookie('oo_OODynamicRewrite_searchPattern',window.OOoDynamicRewrite.searchPattern)}if(window.OOoDynamicRewrite.replacePattern){d.createCookie('oo_OODynamicRewrite_replacePattern',window.OOoDynamicRewrite.replacePattern)}}if(location.search.search('evs')!==-1||d.readCookie('oo_evs_friendly')==='yes'){d.eraseCookie('oo_evs_friendly');b.loadPopupInBackground=true;this.launchPopup();d.createCookie(b.repromptCookie,1,b.repromptTime===-1?0:b.repromptTime)}setTimeout(function(){if(!window.oo_inv_monitor){return}if(b.area&&location.href.search(b.area)===-1){this.options.popupType='popup';this.launchPopup()}else if(b.goal&&location.href.search(b.goal)!==-1){window.oo_inv_monitor.close()}}.bind(this),1600);if(d.readCookie(b.repromptCookie)){return}if(b.thirdPartyCookies&&d.checkThirdPartyCookies(b.thirdPartyCookies)){return}if(!d.readCookie(b.percentageCookie)){d.createCookie(b.percentageCookie,(Math.random()>1-(b.responseRate/100))?"1":"0")}if(typeof b.promptTrigger!=='undefined'){if(b.promptTrigger instanceof RegExp){if(!window.location.href.match(b.promptTrigger)){return}}else if(b.promptTrigger instanceof Array){if(!d.checkTunnel(location.pathname,b.promptTrigger,b.tunnelCookie)){return}}}c+=1;d.createCookie(b.pagesHitCookie,c);if(b.pagesHit&&c<b.pagesHit){return}d.eraseCookie(b.tunnelCookie);if(d.readCookie(b.percentageCookie)==='1'){window.setTimeout(function(){d.createCookie(b.repromptCookie,1,b.repromptTime);this.options.beforePrompt();this.getPrompt()}.bind(this),b.promptDelay*1000)}};d.Invitation.notifyFriendlyLocationChange=function(a){if(window.oo_inv_monitor){d.createCookie('oo_evs_friendly','yes')}};d.Invitation.prototype={getPrompt:function(){d.getPrompt.call(this)},showPrompt:function(a){d.showPrompt.call(this,a,this.launchPopup)},launchPopup:function(){if(this.popupShown){return}this.popupShown=true;var b=this.options,c=window.location.href,e=b.popupType==='popup'?'https://secure.opinionlab.com/ccc01/comment_card.asp?':b.pathToAssets+b.monitorWindow+'?'+(new Date()).getTime()+'&',f,g=[],h=b.asm?[555,500]:[400,335],j,k=d.createMetrics(),l=d.readCookie(b.tealeafCookieName),m;if(b.clickTalePID&&window.ClickTaleGetUID&&window.ClickTaleGetSID){l+='|'+[b.clickTalePID,window.ClickTaleGetUID(),window.ClickTaleGetSID()].join('/')}h=b.newWindowSize||h;m='location=no,status=no,width='+h[0]+',height='+h[1];if(b.referrerRewrite){k.referer=d.referrerRewrite(b.referrerRewrite)}if(b.truncatePrevCurrentMetrics){k.prev=d.truncateMetric(k.prev);k.currentURL=d.truncateMetric(k.currentURL)}if(b.disablePrevCurrentMetrics){k.prev='';k.currentURL=''}if(b.thirdPartyCookies){d.setThirdPartyCookies(b.thirdPartyCookies)}f=d.toQueryString(k)+'&type=Invitation';if(b.customVariables){f+='&customVars='+encodeURIComponent(d.serialize(b.customVariables))}f+='&custom_var='+d.createLegacyVars(b.legacyVariables,l);if(b.asm){f+='&asm=2';m+=',scrollbars=1'}e+=f;if(e.match(/\?/g).length===2)e=e.replace(/\?([^?]*)$/,'&$1');this.popup=j=window.open(e,'OnlineOpinionInvitation',m);if(!b.loadPopupInBackground&&d.$('oo_container')){d.hidePrompt()}if(b.popupType==='popunder'){if(!d.Browser.Chrome){j.blur();window.focus()}else{if(!b.loadPopupInBackground){window.alert(b.chromeMainWinPrompt||'Please fill out the form behind this window when you are finished.')}if(b.chromeSurveyPrompt){setTimeout(function(a){j.postMessage(b.chromeSurveyPrompt,"*")},500)}}}else if(window.oo_inv_monitor){if(!d.Browser.Chrome){window.blur();j.focus()}else{j.alert(b.chromeSurveyPrompt||'Please fill out the form');j.focused=true}}},killPrompt:function(){if(this.options.clickCallbacks&&typeof this.options.clickCallbacks.no==='function'){this.options.clickCallbacks.no()}d.createCookie(this.options.repromptCookie,1,157680000);d.hidePrompt()}};d.extend(d.Invitation,{navigateToFriendlyDomain:function(a){location.href=a}});return d}));