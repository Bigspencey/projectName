function FsrPage(){var self=this;this.init();this.fsrForm=wdk.form("FSR_FORM",{errorPanel:$("#pageError"),check:function(){$.unblockUI();},prepareSubmit:function(){$.blockUI();self.disableUnnecessary();$("#SITContent").find("input[id^=WDS_SEAT_ASSIGNMENT_], input[id^=WDS_SEAT_IS_CHARGEABLE_], input[id^=SEATPRICE_]").each(function(){if($(this).val()!=""){var inputToAdd="<input type='hidden' name='"+$(this).attr("name")+"' value='"+$(this).val()+"'/>";$("#FSR_FORM").append(inputToAdd);}});$("#XBAGContent").find("input[id^=WDS_XBAG_WEIGHT_], input[id^=XBAGPRICE_]").each(function(){if($(this).val()!=""){var inputToAdd="<input type='hidden' name='"+$(this).attr("name")+"' value='"+$(this).val()+"'/>";$("#FSR_FORM").append(inputToAdd);}});return;}});this.initInputs();this.listen();}FsrPage.prototype.initInputs=function(){$("[id^='ADD_INFO_WHEELCHAIR_CATEGORY_']:disabled").addClass("disabled");$('[id^="ADD_INFO_BLIND_"]:disabled').addClass("disabled");$('[id^="ADD_INFO_DEAF_"]:disabled').addClass("disabled");$('[id^="ADD_INFO_BLIND_GUIDE_DOG_"]:disabled').addClass("disabled");$('[id^="ADD_INFO_DEAF_GUIDE_DOG_"]:disabled').addClass("disabled");$('select[id^="ADD_INFO_MEET_AND_ASSIST_"]:disabled').addClass("disabled");$('[id^="ADD_INFO_WHEELCHAIR_HAS_WHEELCHAIR_"]:disabled').addClass("disabled");$('[id^="ADD_INFO_WHEELCHAIR_IS_MANUAL_"]:disabled').addClass("disabled");$('[id^="ADD_INFO_WHEELCHAIR_IS_COLLAPSIBLE_"]:disabled').addClass("disabled");$('[id^="ADD_INFO_WHEELCHAIR_WEIGHT_"]:disabled').addClass("disabled");$('[id^="ADD_INFO_WHEELCHAIR_LENGTH_"]:disabled').addClass("disabled");$('[id^="ADD_INFO_WHEELCHAIR_WIDTH_"]:disabled').addClass("disabled");$('[id^="ADD_INFO_WHEELCHAIR_HEIGHT_"]:disabled').addClass("disabled");$('[id^="ADD_INFO_WHEELCHAIR_NUMBER_"]:disabled').addClass("disabled");$('[id^="ADD_INFO_WHEELCHAIR_"]:disabled').addClass("disabled");$('[id^="ADD_INFO_WHEELCHAIR_BATTERY_TYPE_"]:disabled').addClass("disabled");$('[id^="ADD_INFO_WHEELCHAIR_IS_MANUAL_"]:disabled').addClass("disabled");};FsrPage.prototype.init=function(){$("select").not(".luggage-item, #currencyConvertor select").selectBox();$("[id^='ADD_INFO_WHEELCHAIR_CATEGORY_']").each(function(){var index=this.id.split("_")[4];var selectBattery=$("#ADD_INFO_WHEELCHAIR_BATTERY_TYPE_"+index);selectBattery.val("X");selectBattery.attr("disabled","disabled").addClass("disabled").prop("readonly",true).selectBox("refresh");});};FsrPage.prototype.disableUnnecessary=function(){var self=this;infSpecialServices=false;$('[id^="ADD_INFO_BLIND_"]').each(function(){if(this.id.match(/ADD_INFO_BLIND_[0-9]+$/)){$("#"+this.id+"_HIDDEN").prop("disabled",true);if($(this).val()===$("#"+this.id+"_HIDDEN").val()){$(this).attr("disabled",true);}else{infSpecialServices=true;}if($(this).val()===false){var idSplit=this.id.split("_");var idDogGuide=idSplit[0]+"_"+idSplit[1]+"_"+idSplit[2]+"_GUIDE_DOG_"+idSplit[3];$("#"+idDogGuide).attr("disabled",true);}}});$('[id^="ADD_INFO_DEAF_"]').each(function(){if(this.id.match(/ADD_INFO_DEAF_[0-9]+$/)){$("#"+this.id+"_HIDDEN").prop("disabled",true);if($(this).val()===$("#"+this.id+"_HIDDEN").val()){$(this).attr("disabled",true);}else{infSpecialServices=true;}if($(this).val()===false){var idSplit=this.id.split("_");var idDogGuide=idSplit[0]+"_"+idSplit[1]+"_"+idSplit[2]+"_GUIDE_DOG_"+idSplit[3];$("#"+idDogGuide).attr("disabled",true);}}});$('[id^="ADD_INFO_BLIND_GUIDE_DOG_"]').each(function(){if(this.id.match(/ADD_INFO_BLIND_GUIDE_DOG_[0-9]+$/)){$("#"+this.id+"_HIDDEN").prop("disabled",true);if($(this).val()===$("#"+this.id+"_HIDDEN").val()){$(this).attr("disabled",true);}else{infSpecialServices=true;}}});$('[id^="ADD_INFO_DEAF_GUIDE_DOG_"]').each(function(){if(this.id.match(/ADD_INFO_DEAF_GUIDE_DOG_[0-9]+$/)){$("#"+this.id+"_HIDDEN").prop("disabled",true);if($(this).val()===$("#"+this.id+"_HIDDEN").val()){$(this).attr("disabled",true);}else{infSpecialServices=true;}}});$("select.assistanceneeded").attr("disabled",true);$('select[id^="ADD_INFO_MEET_AND_ASSIST_"]').each(function(){if(this.id.match(/ADD_INFO_MEET_AND_ASSIST_[0-9]+$/)){$("#"+this.id+"_HIDDEN").prop("disabled",true);if(($(this).val()===$("#"+this.id+"_HIDDEN").val())||((($(this).val())==="-")&&($("#"+this.id+"_HIDDEN").val()===""))){$(this).prop("disabled",true);}else{infSpecialServices=true;}}});var isWheelchairInfoChanged=function(id){var elCategory=$("#"+id);var previousValue=elCategory.attr("data-previous-value");var newValue=elCategory.val();if(newValue!=previousValue&&(newValue!="X"||previousValue!="-")){elCategory.removeAttr("disabled");return true;}elCategory.attr("disabled","disabled");return false;};$("[id^='ADD_INFO_WHEELCHAIR_NUMBER_']").each(function(){var index=this.id.split("_")[4];var bCategoryChanged=isWheelchairInfoChanged("ADD_INFO_WHEELCHAIR_CATEGORY_"+index);var bBatteryChanged=isWheelchairInfoChanged("ADD_INFO_WHEELCHAIR_BATTERY_TYPE_"+index);if(bCategoryChanged||bBatteryChanged){infSpecialServices=true;$("input#ADD_INFO_WHEELCHAIR_NUMBER_"+index).removeAttr("disabled");$("input#ADD_INFO_WHEELCHAIR_"+index).removeAttr("disabled");var selectWheelchair=$("#ADD_INFO_WHEELCHAIR_CATEGORY_"+index);var selectBatteryType=$("#ADD_INFO_WHEELCHAIR_BATTERY_TYPE_"+index);if(selectWheelchair.val()=="C"&&selectBatteryType.val()=="X"){selectBatteryType.val("M");}if(bBatteryChanged){if(selectBatteryType.val()=="M"){$("#ADD_INFO_WHEELCHAIR_BATTERY_TYPE_"+index).attr("disabled","disabled");$("input#ADD_INFO_WHEELCHAIR_IS_MANUAL_"+index).val("TRUE");}$("#ADD_INFO_WHEELCHAIR_CATEGORY_"+index).removeAttr("disabled");$("input#ADD_INFO_WHEELCHAIR_HAS_WHEELCHAIR_"+index).removeAttr("disabled");$("input#ADD_INFO_WHEELCHAIR_IS_MANUAL_"+index).removeAttr("disabled");$("input#ADD_INFO_WHEELCHAIR_IS_COLLAPSIBLE_"+index).removeAttr("disabled");$("input#ADD_INFO_WHEELCHAIR_WEIGHT_"+index).removeAttr("disabled");$("input#ADD_INFO_WHEELCHAIR_LENGTH_"+index).removeAttr("disabled");$("input#ADD_INFO_WHEELCHAIR_WIDTH_"+index).removeAttr("disabled");$("input#ADD_INFO_WHEELCHAIR_HEIGHT_"+index).removeAttr("disabled");}}});if(infSpecialServices){$("<input>").attr({type:"hidden",id:"PNRS_CHANGED",name:"PNRS_CHANGED",value:"SS"}).appendTo("form[name=MAIN_PNRS_FORM]");}};FsrPage.prototype.listen=function(){var self=this;$("button.main.right:not(#extendSession)").on("click",function(){theSeatPanel.chargeableSeatsTermsAndConditionsPopin(function(){$.blockUI();$("<input>").attr("type","hidden").attr("name","spNumberOfQues").attr("value",clientSideData.NUMBER_OF_QUESTIONS).appendTo($("#FSR_FORM"));$("<input>").attr("type","hidden").attr("name","spMainQuesAns").attr("value",theAssistancePanel.getMainPanelAnswer()).appendTo($("#FSR_FORM"));$("<input>").attr("type","hidden").attr("name","spDispinConf").attr("value",theAssistancePanel.verifyIfAnswerDeterminesPanelDisplay()).appendTo($("#FSR_FORM"));for(var i=1;i<=clientSideData.NUMBER_OF_QUESTIONS;i++){$("<input>").attr("type","hidden").attr("name","spQuesAns"+i).attr("value",theAssistancePanel.getAnswerToQuestions(i)).appendTo($("#FSR_FORM"));}if(clientSideData.REMARKETING.REMARKETING_ENABLED&&clientSideData.PAGE_CODE=="FSR"){remarketingManager.addFsrRemarketingData();}$("#FSR_FORM").submit();});});$("select.assistanceneeded").change(function(){self.fillAssistanceNeededFields($(this).attr("id"),$(this).val());});$("select.infoWheelchair").change(function(){var wheelchairValue=$(this).val();if($(this).val()!="X"){self.fillInfoWheelchairFields($(this).attr("id"),wheelchairValue);}var index=this.id.split("_")[4];var selectBattery=$("#ADD_INFO_WHEELCHAIR_BATTERY_TYPE_"+index);if(wheelchairValue!="C"){self.fillInfoWheelchairBatteryFields("ADD_INFO_WHEELCHAIR_BATTERY_TYPE_"+index,"X");selectBattery.val("X");selectBattery.attr("disabled","disabled").addClass("disabled").prop("readonly",true).selectBox("refresh");}else{selectBattery.removeAttr("disabled").removeClass("disabled").prop("readonly",false).selectBox("refresh");}});$.each($("select.infoWheelchair"),function(key,value){if($(this).val()!="X"){self.fillInfoWheelchairFields($(this).attr("id"),$(this).val());}});$("select.infoWheelchair, select.infoWheelchairBattery").change(function(){if($(this).val()!="X"){self.fillInfoWheelchairBatteryFields($(this).attr("id"),$(this).val());}});$.each($("select.infoWheelchair, select.infoWheelchairBattery"),function(key,value){if($(this).val()!="X"){self.fillInfoWheelchairBatteryFields($(this).attr("id"),$(this).val());}});};FsrPage.prototype.fillAssistanceNeededFields=function(idSelect,valSelect){var self=this;var idSelectSplit=idSelect.split("_");if((idSelectSplit.length==3)&&(idSelectSplit[2]>0)&&(valSelect.length==3)){var idTraveller=idSelectSplit[2];var blindInfo=valSelect.charAt(0);var deafInfo=valSelect.charAt(1);var dogInfo=valSelect.charAt(2);self.setValue("FSR_FORM","ADD_INFO_BLIND_"+idTraveller,(blindInfo=="X"?false:true));self.setValue("FSR_FORM","ADD_INFO_DEAF_"+idTraveller,(deafInfo=="X"?false:true));self.setValue("FSR_FORM","ADD_INFO_BLIND_GUIDE_DOG_"+idTraveller,(dogInfo=="X"?false:true));self.setValue("FSR_FORM","ADD_INFO_DEAF_GUIDE_DOG_"+idTraveller,(dogInfo=="X"?false:true));}};FsrPage.prototype.fillInfoWheelchairFields=function(idSelect,valSelect){var self=this;var idSelectSplit=idSelect.split("_");if((idSelectSplit.length==5)&&(idSelectSplit[4]>0)){var idTraveller=idSelectSplit[4];self.setValue("FSR_FORM","ADD_INFO_WHEELCHAIR_NUMBER_"+idTraveller,1);if(valSelect=="R"){self.setValue("FSR_FORM","ADD_INFO_WHEELCHAIR_"+idTraveller,"O");}}};FsrPage.prototype.fillInfoWheelchairBatteryFields=function(idSelect,valSelect){var self=this;var idSelectSplit=idSelect.split("_");if((idSelectSplit.length==6)&&(idSelectSplit[5]>0)){var idTraveller=idSelectSplit[5];self.setValue("FSR_FORM","ADD_INFO_WHEELCHAIR_NUMBER_"+idTraveller,1);}};FsrPage.prototype.setValue=function(idForm,idSelect,valSelect){$("#"+idSelect,"#"+idForm).val(valSelect);};$(function(){window.theFsrPage=new FsrPage();setTimeout(function(){$("button[id^='XBAGConfButton_']:visible").trigger("click");},1);});